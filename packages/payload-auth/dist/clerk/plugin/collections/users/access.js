const isAdmin = (req, adminRoles)=>{
    return Boolean(req.user && adminRoles.includes(req.user.role));
};
const isCurrentUser = (req)=>{
    return {
        id: {
            equals: req.user?.id
        }
    };
};
export const getReadAccess = ({ adminRoles })=>{
    return ({ req })=>{
        if (!req.user) return false;
        if (isAdmin(req, adminRoles)) {
            return true;
        }
        return isCurrentUser(req);
    };
};
export const getCreateAccess = ({ adminRoles })=>{
    return ({ req })=>{
        return isAdmin(req, adminRoles);
    };
};
export const getUpdateAccess = ({ adminRoles })=>{
    return ({ req })=>{
        return isAdmin(req, adminRoles);
    };
};
export const getDeleteAccess = ({ adminRoles })=>{
    return ({ req })=>{
        return isAdmin(req, adminRoles);
    };
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9jbGVyay9wbHVnaW4vY29sbGVjdGlvbnMvdXNlcnMvYWNjZXNzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgQWNjZXNzLCBQYXlsb2FkUmVxdWVzdCB9IGZyb20gJ3BheWxvYWQnXG5cbmNvbnN0IGlzQWRtaW4gPSAocmVxOiBhbnksIGFkbWluUm9sZXM6IHN0cmluZ1tdKTogYm9vbGVhbiA9PiB7XG4gIHJldHVybiBCb29sZWFuKHJlcS51c2VyICYmIGFkbWluUm9sZXMuaW5jbHVkZXMocmVxLnVzZXIucm9sZSBhcyBzdHJpbmcpKVxufVxuXG5jb25zdCBpc0N1cnJlbnRVc2VyID0gKHJlcTogUGF5bG9hZFJlcXVlc3QpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDoge1xuICAgICAgZXF1YWxzOiByZXEudXNlcj8uaWRcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGdldFJlYWRBY2Nlc3MgPSAoeyBhZG1pblJvbGVzIH06IHsgYWRtaW5Sb2xlczogc3RyaW5nW10gfSk6IEFjY2VzcyA9PiB7XG4gIHJldHVybiAoeyByZXEgfSkgPT4ge1xuICAgIGlmICghcmVxLnVzZXIpIHJldHVybiBmYWxzZVxuXG4gICAgaWYgKGlzQWRtaW4ocmVxLCBhZG1pblJvbGVzKSkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICByZXR1cm4gaXNDdXJyZW50VXNlcihyZXEpXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGdldENyZWF0ZUFjY2VzcyA9ICh7IGFkbWluUm9sZXMgfTogeyBhZG1pblJvbGVzOiBzdHJpbmdbXSB9KTogQWNjZXNzID0+IHtcbiAgcmV0dXJuICh7IHJlcSB9KSA9PiB7XG4gICAgcmV0dXJuIGlzQWRtaW4ocmVxLCBhZG1pblJvbGVzKVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBnZXRVcGRhdGVBY2Nlc3MgPSAoeyBhZG1pblJvbGVzIH06IHsgYWRtaW5Sb2xlczogc3RyaW5nW10gfSk6IEFjY2VzcyA9PiB7XG4gIHJldHVybiAoeyByZXEgfSkgPT4ge1xuICAgIHJldHVybiBpc0FkbWluKHJlcSwgYWRtaW5Sb2xlcylcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgZ2V0RGVsZXRlQWNjZXNzID0gKHsgYWRtaW5Sb2xlcyB9OiB7IGFkbWluUm9sZXM6IHN0cmluZ1tdIH0pOiBBY2Nlc3MgPT4ge1xuICByZXR1cm4gKHsgcmVxIH0pID0+IHtcbiAgICByZXR1cm4gaXNBZG1pbihyZXEsIGFkbWluUm9sZXMpXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJpc0FkbWluIiwicmVxIiwiYWRtaW5Sb2xlcyIsIkJvb2xlYW4iLCJ1c2VyIiwiaW5jbHVkZXMiLCJyb2xlIiwiaXNDdXJyZW50VXNlciIsImlkIiwiZXF1YWxzIiwiZ2V0UmVhZEFjY2VzcyIsImdldENyZWF0ZUFjY2VzcyIsImdldFVwZGF0ZUFjY2VzcyIsImdldERlbGV0ZUFjY2VzcyJdLCJtYXBwaW5ncyI6IkFBRUEsTUFBTUEsVUFBVSxDQUFDQyxLQUFVQztJQUN6QixPQUFPQyxRQUFRRixJQUFJRyxJQUFJLElBQUlGLFdBQVdHLFFBQVEsQ0FBQ0osSUFBSUcsSUFBSSxDQUFDRSxJQUFJO0FBQzlEO0FBRUEsTUFBTUMsZ0JBQWdCLENBQUNOO0lBQ3JCLE9BQU87UUFDTE8sSUFBSTtZQUNGQyxRQUFRUixJQUFJRyxJQUFJLEVBQUVJO1FBQ3BCO0lBQ0Y7QUFDRjtBQUVBLE9BQU8sTUFBTUUsZ0JBQWdCLENBQUMsRUFBRVIsVUFBVSxFQUE0QjtJQUNwRSxPQUFPLENBQUMsRUFBRUQsR0FBRyxFQUFFO1FBQ2IsSUFBSSxDQUFDQSxJQUFJRyxJQUFJLEVBQUUsT0FBTztRQUV0QixJQUFJSixRQUFRQyxLQUFLQyxhQUFhO1lBQzVCLE9BQU87UUFDVDtRQUVBLE9BQU9LLGNBQWNOO0lBQ3ZCO0FBQ0YsRUFBQztBQUVELE9BQU8sTUFBTVUsa0JBQWtCLENBQUMsRUFBRVQsVUFBVSxFQUE0QjtJQUN0RSxPQUFPLENBQUMsRUFBRUQsR0FBRyxFQUFFO1FBQ2IsT0FBT0QsUUFBUUMsS0FBS0M7SUFDdEI7QUFDRixFQUFDO0FBRUQsT0FBTyxNQUFNVSxrQkFBa0IsQ0FBQyxFQUFFVixVQUFVLEVBQTRCO0lBQ3RFLE9BQU8sQ0FBQyxFQUFFRCxHQUFHLEVBQUU7UUFDYixPQUFPRCxRQUFRQyxLQUFLQztJQUN0QjtBQUNGLEVBQUM7QUFFRCxPQUFPLE1BQU1XLGtCQUFrQixDQUFDLEVBQUVYLFVBQVUsRUFBNEI7SUFDdEUsT0FBTyxDQUFDLEVBQUVELEdBQUcsRUFBRTtRQUNiLE9BQU9ELFFBQVFDLEtBQUtDO0lBQ3RCO0FBQ0YsRUFBQyJ9