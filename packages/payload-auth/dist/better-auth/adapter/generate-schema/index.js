import fs from "node:fs/promises";
import path from "node:path";
import { generateSchemaBuilderStage } from "./generate-schema-builder";
import { getPayloadSchema } from "./get-payload-schema";
export const generateSchema = async (BAoptions, options = {
    outputDir: './generated'
})=>{
    const { outputDir } = options;
    const existing_schema_code = await getPayloadSchema(outputDir);
    const new_schema_code = await generateSchemaBuilderStage({
        code: existing_schema_code,
        BAOptions: BAoptions
    });
    const schemaPath = path.resolve(outputDir, 'schema.ts');
    await fs.writeFile(schemaPath, new_schema_code, 'utf8');
    return new_schema_code;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9iZXR0ZXItYXV0aC9hZGFwdGVyL2dlbmVyYXRlLXNjaGVtYS9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnbm9kZTpmcy9wcm9taXNlcydcbmltcG9ydCBwYXRoIGZyb20gJ25vZGU6cGF0aCdcbmltcG9ydCB0eXBlIHsgQmV0dGVyQXV0aE9wdGlvbnMgfSBmcm9tICdiZXR0ZXItYXV0aCdcbmltcG9ydCB7IGdlbmVyYXRlU2NoZW1hQnVpbGRlclN0YWdlIH0gZnJvbSAnLi9nZW5lcmF0ZS1zY2hlbWEtYnVpbGRlcidcbmltcG9ydCB7IGdldFBheWxvYWRTY2hlbWEgfSBmcm9tICcuL2dldC1wYXlsb2FkLXNjaGVtYSdcblxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlU2NoZW1hID0gYXN5bmMgKFxuICBCQW9wdGlvbnM6IEJldHRlckF1dGhPcHRpb25zLFxuICBvcHRpb25zOiB7IG91dHB1dERpcjogc3RyaW5nIH0gPSB7XG4gICAgb3V0cHV0RGlyOiAnLi9nZW5lcmF0ZWQnXG4gIH1cbik6IFByb21pc2U8c3RyaW5nPiA9PiB7XG4gIGNvbnN0IHsgb3V0cHV0RGlyIH0gPSBvcHRpb25zXG4gIGNvbnN0IGV4aXN0aW5nX3NjaGVtYV9jb2RlOiBzdHJpbmcgPSBhd2FpdCBnZXRQYXlsb2FkU2NoZW1hKG91dHB1dERpcilcblxuICBjb25zdCBuZXdfc2NoZW1hX2NvZGUgPSBhd2FpdCBnZW5lcmF0ZVNjaGVtYUJ1aWxkZXJTdGFnZSh7XG4gICAgY29kZTogZXhpc3Rpbmdfc2NoZW1hX2NvZGUsXG4gICAgQkFPcHRpb25zOiBCQW9wdGlvbnNcbiAgfSlcblxuICBjb25zdCBzY2hlbWFQYXRoID0gcGF0aC5yZXNvbHZlKG91dHB1dERpciwgJ3NjaGVtYS50cycpXG4gIGF3YWl0IGZzLndyaXRlRmlsZShzY2hlbWFQYXRoLCBuZXdfc2NoZW1hX2NvZGUsICd1dGY4JylcblxuICByZXR1cm4gbmV3X3NjaGVtYV9jb2RlXG59XG4iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwiZ2VuZXJhdGVTY2hlbWFCdWlsZGVyU3RhZ2UiLCJnZXRQYXlsb2FkU2NoZW1hIiwiZ2VuZXJhdGVTY2hlbWEiLCJCQW9wdGlvbnMiLCJvcHRpb25zIiwib3V0cHV0RGlyIiwiZXhpc3Rpbmdfc2NoZW1hX2NvZGUiLCJuZXdfc2NoZW1hX2NvZGUiLCJjb2RlIiwiQkFPcHRpb25zIiwic2NoZW1hUGF0aCIsInJlc29sdmUiLCJ3cml0ZUZpbGUiXSwibWFwcGluZ3MiOiJBQUFBLE9BQU9BLFFBQVEsbUJBQWtCO0FBQ2pDLE9BQU9DLFVBQVUsWUFBVztBQUU1QixTQUFTQywwQkFBMEIsUUFBUSw0QkFBMkI7QUFDdEUsU0FBU0MsZ0JBQWdCLFFBQVEsdUJBQXNCO0FBRXZELE9BQU8sTUFBTUMsaUJBQWlCLE9BQzVCQyxXQUNBQyxVQUFpQztJQUMvQkMsV0FBVztBQUNiLENBQUM7SUFFRCxNQUFNLEVBQUVBLFNBQVMsRUFBRSxHQUFHRDtJQUN0QixNQUFNRSx1QkFBK0IsTUFBTUwsaUJBQWlCSTtJQUU1RCxNQUFNRSxrQkFBa0IsTUFBTVAsMkJBQTJCO1FBQ3ZEUSxNQUFNRjtRQUNORyxXQUFXTjtJQUNiO0lBRUEsTUFBTU8sYUFBYVgsS0FBS1ksT0FBTyxDQUFDTixXQUFXO0lBQzNDLE1BQU1QLEdBQUdjLFNBQVMsQ0FBQ0YsWUFBWUgsaUJBQWlCO0lBRWhELE9BQU9BO0FBQ1QsRUFBQyJ9