import { supportedBAPluginIds } from "../constants";
import { checkPluginExists } from "../helpers/check-plugin-exists";
export function setLoginMethods({ pluginOptions }) {
    const betterAuthOptions = pluginOptions.betterAuthOptions ?? {};
    if (pluginOptions?.admin?.loginMethods) return pluginOptions // If user defined, exit early
    ;
    const loginMethods = Object.keys(betterAuthOptions?.socialProviders ?? {});
    if (!!betterAuthOptions?.emailAndPassword || betterAuthOptions?.emailAndPassword?.enabled) loginMethods.push('emailPassword');
    if (checkPluginExists(betterAuthOptions, supportedBAPluginIds.passkey)) loginMethods.push('passkey');
    pluginOptions.admin = pluginOptions.admin ?? {};
    pluginOptions.admin.loginMethods = loginMethods;
    return pluginOptions;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9iZXR0ZXItYXV0aC9wbHVnaW4vbGliL3NldC1sb2dpbi1tZXRob2RzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHN1cHBvcnRlZEJBUGx1Z2luSWRzIH0gZnJvbSAnLi4vY29uc3RhbnRzJ1xuaW1wb3J0IHsgY2hlY2tQbHVnaW5FeGlzdHMgfSBmcm9tICcuLi9oZWxwZXJzL2NoZWNrLXBsdWdpbi1leGlzdHMnXG5pbXBvcnQgeyBCZXR0ZXJBdXRoUGx1Z2luT3B0aW9ucywgTG9naW5NZXRob2QgfSBmcm9tICcuLi90eXBlcydcblxuZXhwb3J0IGZ1bmN0aW9uIHNldExvZ2luTWV0aG9kcyh7IHBsdWdpbk9wdGlvbnMgfTogeyBwbHVnaW5PcHRpb25zOiBCZXR0ZXJBdXRoUGx1Z2luT3B0aW9ucyB9KSB7XG4gIGNvbnN0IGJldHRlckF1dGhPcHRpb25zID0gcGx1Z2luT3B0aW9ucy5iZXR0ZXJBdXRoT3B0aW9ucyA/PyB7fVxuICBpZiAocGx1Z2luT3B0aW9ucz8uYWRtaW4/LmxvZ2luTWV0aG9kcykgcmV0dXJuIHBsdWdpbk9wdGlvbnMgLy8gSWYgdXNlciBkZWZpbmVkLCBleGl0IGVhcmx5XG4gIGNvbnN0IGxvZ2luTWV0aG9kcyA9IE9iamVjdC5rZXlzKGJldHRlckF1dGhPcHRpb25zPy5zb2NpYWxQcm92aWRlcnMgPz8ge30pXG4gIGlmICghIWJldHRlckF1dGhPcHRpb25zPy5lbWFpbEFuZFBhc3N3b3JkIHx8IGJldHRlckF1dGhPcHRpb25zPy5lbWFpbEFuZFBhc3N3b3JkPy5lbmFibGVkKSBsb2dpbk1ldGhvZHMucHVzaCgnZW1haWxQYXNzd29yZCcpXG4gIGlmIChjaGVja1BsdWdpbkV4aXN0cyhiZXR0ZXJBdXRoT3B0aW9ucywgc3VwcG9ydGVkQkFQbHVnaW5JZHMucGFzc2tleSkpIGxvZ2luTWV0aG9kcy5wdXNoKCdwYXNza2V5JylcbiAgcGx1Z2luT3B0aW9ucy5hZG1pbiA9IHBsdWdpbk9wdGlvbnMuYWRtaW4gPz8ge31cbiAgcGx1Z2luT3B0aW9ucy5hZG1pbi5sb2dpbk1ldGhvZHMgPSBsb2dpbk1ldGhvZHMgYXMgTG9naW5NZXRob2RbXVxuICByZXR1cm4gcGx1Z2luT3B0aW9uc1xufVxuIl0sIm5hbWVzIjpbInN1cHBvcnRlZEJBUGx1Z2luSWRzIiwiY2hlY2tQbHVnaW5FeGlzdHMiLCJzZXRMb2dpbk1ldGhvZHMiLCJwbHVnaW5PcHRpb25zIiwiYmV0dGVyQXV0aE9wdGlvbnMiLCJhZG1pbiIsImxvZ2luTWV0aG9kcyIsIk9iamVjdCIsImtleXMiLCJzb2NpYWxQcm92aWRlcnMiLCJlbWFpbEFuZFBhc3N3b3JkIiwiZW5hYmxlZCIsInB1c2giLCJwYXNza2V5Il0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxvQkFBb0IsUUFBUSxlQUFjO0FBQ25ELFNBQVNDLGlCQUFpQixRQUFRLGlDQUFnQztBQUdsRSxPQUFPLFNBQVNDLGdCQUFnQixFQUFFQyxhQUFhLEVBQThDO0lBQzNGLE1BQU1DLG9CQUFvQkQsY0FBY0MsaUJBQWlCLElBQUksQ0FBQztJQUM5RCxJQUFJRCxlQUFlRSxPQUFPQyxjQUFjLE9BQU9ILGNBQWMsOEJBQThCOztJQUMzRixNQUFNRyxlQUFlQyxPQUFPQyxJQUFJLENBQUNKLG1CQUFtQkssbUJBQW1CLENBQUM7SUFDeEUsSUFBSSxDQUFDLENBQUNMLG1CQUFtQk0sb0JBQW9CTixtQkFBbUJNLGtCQUFrQkMsU0FBU0wsYUFBYU0sSUFBSSxDQUFDO0lBQzdHLElBQUlYLGtCQUFrQkcsbUJBQW1CSixxQkFBcUJhLE9BQU8sR0FBR1AsYUFBYU0sSUFBSSxDQUFDO0lBQzFGVCxjQUFjRSxLQUFLLEdBQUdGLGNBQWNFLEtBQUssSUFBSSxDQUFDO0lBQzlDRixjQUFjRSxLQUFLLENBQUNDLFlBQVksR0FBR0E7SUFDbkMsT0FBT0g7QUFDVCJ9