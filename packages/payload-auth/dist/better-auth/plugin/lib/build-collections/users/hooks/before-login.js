import { APIError } from "payload";
/**
 * This hook blocks login attempts if email verification is required and the user's email is not verified
 */ export function getBeforeLoginHook(betterAuthOptions) {
    const hook = async ({ user })=>{
        const requireEmailVerification = betterAuthOptions.emailAndPassword?.requireEmailVerification ?? false;
        if (requireEmailVerification && !user.emailVerified) {
            throw new APIError('Email verification required. Please verify your email before logging in.', 403);
        }
        return user;
    };
    return hook;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3NyYy9iZXR0ZXItYXV0aC9wbHVnaW4vbGliL2J1aWxkLWNvbGxlY3Rpb25zL3VzZXJzL2hvb2tzL2JlZm9yZS1sb2dpbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBUElFcnJvciwgQ29sbGVjdGlvbkJlZm9yZUxvZ2luSG9vayB9IGZyb20gJ3BheWxvYWQnXG5pbXBvcnQgdHlwZSB7IEJldHRlckF1dGhPcHRpb25zIH0gZnJvbSAnQC9iZXR0ZXItYXV0aC9wbHVnaW4vdHlwZXMnXG4vKipcbiAqIFRoaXMgaG9vayBibG9ja3MgbG9naW4gYXR0ZW1wdHMgaWYgZW1haWwgdmVyaWZpY2F0aW9uIGlzIHJlcXVpcmVkIGFuZCB0aGUgdXNlcidzIGVtYWlsIGlzIG5vdCB2ZXJpZmllZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmVmb3JlTG9naW5Ib29rKGJldHRlckF1dGhPcHRpb25zOiBCZXR0ZXJBdXRoT3B0aW9ucykge1xuICBjb25zdCBob29rOiBDb2xsZWN0aW9uQmVmb3JlTG9naW5Ib29rID0gYXN5bmMgKHsgdXNlciB9KSA9PiB7XG4gICAgY29uc3QgcmVxdWlyZUVtYWlsVmVyaWZpY2F0aW9uID0gYmV0dGVyQXV0aE9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucmVxdWlyZUVtYWlsVmVyaWZpY2F0aW9uID8/IGZhbHNlXG5cbiAgICBpZiAocmVxdWlyZUVtYWlsVmVyaWZpY2F0aW9uICYmICF1c2VyLmVtYWlsVmVyaWZpZWQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcignRW1haWwgdmVyaWZpY2F0aW9uIHJlcXVpcmVkLiBQbGVhc2UgdmVyaWZ5IHlvdXIgZW1haWwgYmVmb3JlIGxvZ2dpbmcgaW4uJywgNDAzKVxuICAgIH1cblxuICAgIHJldHVybiB1c2VyXG4gIH1cblxuICByZXR1cm4gaG9va1xufVxuIl0sIm5hbWVzIjpbIkFQSUVycm9yIiwiZ2V0QmVmb3JlTG9naW5Ib29rIiwiYmV0dGVyQXV0aE9wdGlvbnMiLCJob29rIiwidXNlciIsInJlcXVpcmVFbWFpbFZlcmlmaWNhdGlvbiIsImVtYWlsQW5kUGFzc3dvcmQiLCJlbWFpbFZlcmlmaWVkIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxRQUFRLFFBQW1DLFVBQVM7QUFFN0Q7O0NBRUMsR0FDRCxPQUFPLFNBQVNDLG1CQUFtQkMsaUJBQW9DO0lBQ3JFLE1BQU1DLE9BQWtDLE9BQU8sRUFBRUMsSUFBSSxFQUFFO1FBQ3JELE1BQU1DLDJCQUEyQkgsa0JBQWtCSSxnQkFBZ0IsRUFBRUQsNEJBQTRCO1FBRWpHLElBQUlBLDRCQUE0QixDQUFDRCxLQUFLRyxhQUFhLEVBQUU7WUFDbkQsTUFBTSxJQUFJUCxTQUFTLDRFQUE0RTtRQUNqRztRQUVBLE9BQU9JO0lBQ1Q7SUFFQSxPQUFPRDtBQUNUIn0=